'''
Copyright 2022 Airbus SAS

Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at

    http://www.apache.org/licenses/LICENSE-2.0

Unless required by applicable law or agreed to in writing, software
distributed under the License is distributed on an "AS IS" BASIS,
WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
See the License for the specific language governing permissions and
limitations under the License.
'''
# mode: python; py-indent-offset: 4; tab-width: 8; coding:utf-8
from sos_trades_core.tools.post_processing.post_processing_factory import PostProcessingFactory
from sos_trades_core.study_manager.study_manager import StudyManager
import pandas as pd


class Study(StudyManager):

    def __init__(self, execution_engine=None):
        super().__init__(__file__, execution_engine=execution_engine)

    def setup_usecase(self):
        setup_data_list = []

        rc = {'years': {0: 2020, 1: 2021, 2: 2022, 3: 2023, 4: 2024, 5: 2025, 6: 2026,
                        7: 2027, 8: 2028, 9: 2029, 10: 2030, 11: 2031, 12: 2032, 13: 2033,
                        14: 2034, 15: 2035, 16: 2036, 17: 2037, 18: 2038, 19: 2039, 20: 2040,
                        21: 2041, 22: 2042, 23: 2043, 24: 2044, 25: 2045, 26: 2046, 27: 2047,
                        28: 2048, 29: 2049, 30: 2050},
              'RC': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0,
                     8: 0.0, 9: 0.0, 10: 64323897.55428336, 11: 57409078.5671979, 12: 54620637.608219706,
                     13: 54207292.24253589, 14: 54779480.32731821, 15: 55352873.01859482, 16: 55927289.62539155,
                     17: 55959248.076606065, 18: 56524273.4940786, 19: 57089516.22901938, 20: 58231306.553599775,
                     21: 59395932.68467176, 22: 60583851.3383652, 23: 61795528.36513251, 24: 63031438.93243516,
                     25: 64292067.71108387, 26: 65577909.06530554, 27: 66889467.246611655, 28: 68227256.5915439,
                     29: 69591801.72337477, 30: 70983637.75784227}}

        rc_df = pd.DataFrame.from_dict(rc)

        nrc = {'years': {0: 2020, 1: 2021, 2: 2022, 3: 2023, 4: 2024, 5: 2025, 6: 2026, 7: 2027, 8: 2028,
                         9: 2029, 10: 2030, 11: 2031, 12: 2032, 13: 2033, 14: 2034, 15: 2035, 16: 2036,
                         17: 2037, 18: 2038, 19: 2039, 20: 2040, 21: 2041, 22: 2042, 23: 2043, 24: 2044,
                         25: 2045, 26: 2046, 27: 2047, 28: 2048, 29: 2049, 30: 2050},
               'NRC_wo_cont_dev': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 682667146.2192988,
                                   5: 1044480733.7155272, 6: 1065370348.3898377, 7: 2173355510.715269,
                                   8: 1108411310.4647872, 9: 1130579536.674083, 10: 384397042.4691883,
                                   11: 392084983.318572, 12: 399926682.9849434, 13: 407925216.64464235,
                                   14: 83216744.19550702, 15: 84881079.07941718, 16: 86578700.66100553,
                                   17: 88310274.67422564, 18: 90076480.16771016, 19: 91878009.77106436,
                                   20: 93715569.96648565, 21: 95589881.36581536, 22: 97501678.99313167,
                                   23: 99451712.57299429, 24: 101440746.8244542, 25: 103469561.76094328,
                                   26: 105538952.99616215, 27: 107649732.0560854, 28: 109802726.6972071,
                                   29: 111998781.23115124, 30: 114238756.85577427},
               'cont_dev': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0,
                            10: 179624454.04635397, 11: 254058239.99323192, 12: 299239460.53412145,
                            13: 277091094.04186505, 14: 253440357.1557377, 15: 232514278.0927365,
                            16: 236912462.07217875, 17: 237047840.62193426, 18: 239441333.3816121,
                            19: 246564378.63444492, 20: 251495666.20713386, 21: 256525579.53127646,
                            22: 261656091.12190202, 23: 266889212.9443401, 24: 272226997.2032269,
                            25: 277671537.1472915, 26: 283224967.8902373, 27: 288889467.24804205,
                            28: 294667256.5930029, 29: 300560601.72486293, 30: 306571813.75936025},
               'PPE_LB_Airframe': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 109226743.39508781,
                                   5: 167116917.39448434, 6: 170459255.74237403, 7: 347736881.714443,
                                   8: 177345809.67436597, 9: 180892725.86785325, 10: 61503526.79507012,
                                   11: 62733597.33097152, 12: 63988269.277590945, 13: 65268034.66314278,
                                   14: 13314679.071281124, 15: 13580972.652706748, 16: 13852592.105760884,
                                   17: 14129643.947876101, 18: 14412236.826833624, 19: 14700481.563370297,
                                   20: 14994491.194637703, 21: 15294381.018530456, 22: 15600268.638901066,
                                   23: 15912274.011679089, 24: 16230519.491912672, 25: 16555129.881750925,
                                   26: 16886232.479385942, 27: 17223957.128973663, 28: 17568436.271553136,
                                   29: 17919804.9969842, 30: 18278201.096923884},
               'PPE_Machinery_Airframe': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 75093386.08412287, 5: 114892880.70870799,
                                          6: 117190738.32288216, 7: 239069106.17867956, 8: 121925244.1511266,
                                          9: 124363749.03414913, 10: 42283674.671610706, 11: 43129348.16504292,
                                          12: 43991935.128343776, 13: 44871773.83091065, 14: 9153841.861505773,
                                          15: 9336918.698735889, 16: 9523657.072710607, 17: 9714130.21416482,
                                          18: 9908412.818448117, 19: 10106581.074817078, 20: 10308712.696313422,
                                          21: 10514886.95023969, 22: 10725184.689244483, 23: 10939688.383029373,
                                          24: 11158482.150689961, 25: 11381651.793703761, 26: 11609284.829577835,
                                          27: 11841470.526169393, 28: 12078299.936692782, 29: 12319865.935426638,
                                          30: 12566263.25413517},
               'NRC_wo_Contingency': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 866987275.6985096, 5: 1326490531.8187196,
                                      6: 1353020342.4550939, 7: 2760161498.608392, 8: 1407682364.2902799,
                                      9: 1435836011.5760853, 10: 667808697.9822232, 11: 752006168.8078183,
                                      12: 807146347.9249997, 13: 795156119.180561, 14: 359125622.28403157,
                                      15: 340313248.52359635, 16: 346867411.9116558, 17: 349201889.4582008,
                                      18: 353838463.194604, 19: 363249451.04369664, 20: 370514440.06457067,
                                      21: 377924728.86586195, 22: 385483223.44317925, 23: 393192887.9120429,
                                      24: 401056745.67028373, 25: 409077880.58368945, 26: 417259438.1953632,
                                      27: 425604626.95927054, 28: 434116719.49845594, 29: 442799053.888425,
                                      30: 451655034.9661936},
               'NRC': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 866987275.6985093, 5: 1326490531.8187194,
                       6: 1353020342.4550939, 7: 2760161498.6083913, 8: 1407682364.2902799, 9: 1435836011.5760853,
                       10: 577996470.9590461, 11: 624977048.8112023, 12: 657526617.657939, 13: 656610572.1596284,
                       14: 232405443.70616278, 15: 224056109.47722805, 16: 228411180.87556636, 17: 230677969.1472337,
                       18: 234117796.50379798, 19: 239967261.7264742, 20: 244766606.96100372, 21: 249661939.10022375,
                       22: 254655177.8822282, 23: 259748281.43987283, 24: 264943247.0686703, 25: 270242112.0100437,
                       26: 275646954.2502446, 27: 281159893.3352495, 28: 286783091.20195454, 29: 292518753.0259935,
                       30: 298369128.08651346},
               'NRC_amort': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 331087161.90935975, 5: 506563357.7213204,
                             6: 516694624.8757468, 7: 1054057034.7465235, 8: 537569087.7207271, 9: 548320469.4751415,
                             10: 186428959.62154815, 11: 190157538.8139791, 12: 193960689.59025866,
                             13: 197839903.3820639, 14: 40359340.28994103, 15: 41166527.09573985,
                             16: 41989857.63765465, 17: 42829654.79040775, 18: 43686247.886215895,
                             19: 44559972.84394021, 20: 45451172.300819024, 21: 46360195.746835396,
                             22: 47287399.66177211, 23: 48233147.655007556, 24: 49197810.60810771,
                             25: 50181766.82026986, 26: 51185402.156675264, 27: 52209110.19980877,
                             28: 53253292.40380495, 29: 54318358.25188104, 30: 55404725.416918665},
               'NRC_non_amort': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 351579984.3099389, 5: 537917375.9942067,
                                 6: 548675723.5140909, 7: 1119298475.9687455, 8: 570842222.7440602,
                                 9: 582259067.1989413, 10: 108155855.82446316, 11: 74898324.5079768,
                                 12: 56346263.127624154, 13: 71539766.24164599, 14: -83862774.67230287,
                                 15: -72542587.06269094, 16: -73867388.01273853, 17: -73043300.42714924,
                                 18: -73330434.40931177, 19: -75964152.39009833, 20: -77483435.4379003,
                                 21: -79033104.14665824, 22: -80613766.22959146, 23: -82226041.5541833,
                                 24: -83870562.38526696, 25: -85547973.63297233, 26: -87258933.10563171,
                                 27: -89004111.76774439, 28: -90784194.00309923, 29: -92599877.88316125,
                                 30: -94451875.44082451}}

        nrc_df = pd.DataFrame.from_dict(nrc)

        sale_price = {'years': {0: 2020, 1: 2021, 2: 2022, 3: 2023, 4: 2024, 5: 2025, 6: 2026, 7: 2027, 8: 2028,
                                9: 2029, 10: 2030, 11: 2031, 12: 2032, 13: 2033, 14: 2034, 15: 2035, 16: 2036,
                                17: 2037, 18: 2038, 19: 2039, 20: 2040, 21: 2041, 22: 2042, 23: 2043, 24: 2044,
                                25: 2045, 26: 2046, 27: 2047, 28: 2048, 29: 2049, 30: 2050},
                      'sale_price': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.0, 5: 0.0, 6: 0.0,
                                     7: 0.0, 8: 0.0, 9: 0.0, 10: 134820782.85142016, 11: 137517198.50844857,
                                     12: 140267542.47861752, 13: 143072893.3281899, 14: 145934351.19475368,
                                     15: 148853038.21864876, 16: 151830098.98302174, 17: 154866700.9626822, 18: 157964034.98193583, 19: 161123315.68157455,
                                     20: 164345781.99520606, 21: 167632697.63511017, 22: 170985351.58781236, 23: 174405058.61956865, 24: 177893159.79196,
                                     25: 181451022.9877992, 26: 185080043.44755518, 27: 188781644.3165063, 28: 192557277.20283645, 29: 196408422.74689317,
                                     30: 200336591.20183104}}
        sale_price_df = pd.DataFrame.from_dict(sale_price)
        sls_qty = {'years': {0: 2020.0, 1: 2021.0, 2: 2022.0, 3: 2023.0, 4: 2024.0, 5: 2025.0, 6: 2026.0,
                             7: 2027.0, 8: 2028.0, 9: 2029.0, 10: 2030.0, 11: 2031.0, 12: 2032.0, 13: 2033.0,
                             14: 2034.0, 15: 2035.0, 16: 2036.0, 17: 2037.0, 18: 2038.0, 19: 2039.0, 20: 2040.0,
                             21: 2041.0, 22: 2042.0, 23: 2043.0, 24: 2044.0, 25: 2045.0, 26: 2046.0, 27: 2047.0,
                             28: 2048.0, 29: 2049.0, 30: 2050.0},
                   'quantity': {0: 331.0, 1: 303.0, 2: 275.0, 3: 247.0, 4: 219.0, 5: 191.0, 6: 163.0,
                                7: 135.0, 8: 107.0, 9: 79.0, 10: 51.0, 11: 23.0, 12: 131.0, 13: 481.0,
                                14: 658.0, 15: 731.0, 16: 757.0, 17: 810.0, 18: 790.0, 19: 784.0,
                                20: 741.0, 21: 731.0, 22: 715.0, 23: 713.0, 24: 678.0, 25: 625.0,
                                26: 585.0, 27: 561.0, 28: 551.0, 29: 496.0, 30: 498.0}}
        sls_qty_df = pd.DataFrame.from_dict(sls_qty)

        dmc = {'years': {0: 2020, 1: 2021, 2: 2022, 3: 2023, 4: 2024, 5: 2025, 6: 2026, 7: 2027, 8: 2028, 9: 2029,
                         10: 2030, 11: 2031, 12: 2032, 13: 2033, 14: 2034, 15: 2035, 16: 2036, 17: 2037, 18: 2038,
                         19: 2039, 20: 2040, 21: 2041, 22: 2042, 23: 2043, 24: 2044, 25: 2045, 26: 2046,
                         27: 2047, 28: 2048, 29: 2049, 30: 2050},
               'DMC_age0': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0,
                            9: 0.0, 10: 176.619935113722, 11: 178.78693659961485, 12: 181.01311738890735,
                            13: 183.29907123382858, 14: 185.6454137741956, 15: 188.05278279336608,
                            16: 190.52183848110934, 17: 193.05326370331213, 18: 195.6477642784601,
                            19: 198.30606926086307, 20: 201.02893123061625, 21: 203.81712659031302,
                            22: 206.6714558685501, 23: 209.59274403028456, 24: 212.58184079412524,
                            25: 215.6396209566598, 26: 218.7669847239352, 27: 221.96485805022928,
                            28: 225.23419298426273, 29: 228.57596802301873, 30: 231.9911884733479},
               'DMC_age1': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 10: 210.8044386841198, 11: 213.39085981244347, 12: 216.0479143028894, 13: 218.7763108274728, 14: 221.5767841821044, 15: 224.4500955920821, 16: 227.3970330258402, 17: 230.41841151685642, 18: 233.5150734936459, 19: 236.68788911780436, 20: 239.93775663009035, 21: 243.26560270456716, 22: 246.67238281085014, 23: 250.15908158453314, 24: 253.72671320589143, 25: 257.37632178698107, 26: 261.10898176727756, 27: 264.9257983180156, 28: 268.82790775541037, 29: 272.81647796295783, 30: 276.89270882302816}, 'DMC_age2': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 10: 353.239870227444, 11: 357.5738731992297, 12: 362.0262347778147, 13: 366.59814246765717, 14: 371.2908275483912, 15: 376.10556558673215, 16: 381.0436769622187, 17: 386.10652740662425, 18: 391.2955285569202, 19: 396.61213852172614, 20: 402.0578624612325, 21: 407.63425318062605, 22: 413.3429117371002, 23: 419.1854880605691, 24: 425.1636815882505, 25: 431.2792419133196, 26: 437.5339694478704, 27: 443.92971610045856, 28: 450.46838596852547, 29: 457.15193604603746, 30: 463.9823769466958}, 'DMC_age3': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 10: 415.9114601065067, 11: 421.01439908941546, 12: 426.2566957867819, 13: 431.63974838933825, 14: 437.16500662955735, 15: 442.83397238437817, 16: 448.64820029422526, 17: 454.60929839812206, 18: 460.7189287847609, 19: 466.9788082594518, 20: 473.39070902693504, 21: 479.95645939009194, 22: 486.6779444646503, 23: 493.5571069100249, 24: 500.5959476764885, 25: 507.7965267689085, 26: 515.1609640273314, 27: 522.6914399247335, 28: 530.390196382296, 29: 538.2595376025926, 30: 546.3018309211096}, 'DMC_age4': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 10: 478.5830499855693, 11: 484.4549249796014, 12: 490.487156795749, 13: 496.6813543110194, 14: 503.0391857107235, 15: 509.56237918202424, 16: 516.2527236262317, 17: 523.1120693896198, 18: 530.1423290126016, 19: 537.3454779971773, 20: 544.7235555926376, 21: 552.2786655995579, 22: 560.0129771922003, 23: 567.9287257594807, 24: 576.0282137647265, 25: 584.3138116244976, 26: 592.7879586067922, 27: 601.4531637490084, 28: 610.3120067960667, 29: 619.3671391591475, 30: 628.6212848955234}, 'DMC_age5': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 10: 569.7417261732968, 11: 576.7320535471445, 12: 583.9132818997011, 13: 591.2873265607375, 14: 598.8561734651471, 15: 606.6218799786003, 16: 614.5865757455141, 17: 622.7524635590715, 18: 631.1218202530971, 19: 639.6969976156873, 20: 648.4804233245685, 21: 657.4746019042357, 22: 666.6821157050003, 23: 676.1056259041437, 24: 685.7478735294363, 25: 695.6116805053542, 26: 705.6999507223717, 27: 716.0156711297719, 28: 726.5619128524604, 29: 737.3418323323186, 30: 748.3586724946707}, 'dmc_age': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 10: 149385.59431872598, 11: 333839.40227577987, 12: 652254.1689622328, 13: 1048116.013629717, 14: 1530521.9001072291, 15: 2126546.456794179, 16: 2761894.333916144, 17: 3435223.7930332934, 18: 4154540.3103080066, 19: 4911998.3925092295, 20: 5707151.813341541, 21: 6535872.008547012, 22: 7397855.571462019, 23: 8292975.251583261, 24: 9216509.434593195, 25: 10167775.383483423, 26: 11145556.259457968, 27: 12148618.87899763, 28: 13175244.301179323, 29: 14223140.29507968, 30: 14656387.873685045}, 'NRC_wo_cont_dev': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 992621085.028061, 5: 1518710260.0929334, 6: 1549084465.294792, 7: 3160132309.2013755, 8: 1611667477.6927018, 9: 1643900827.2465558, 10: 558926281.263829, 11: 570104806.8891057, 12: 581506903.0268877, 13: 593137041.0874255, 14: 120999956.3818348, 15: 123419955.5094715, 16: 125888354.61966093, 17: 128406121.71205416, 18: 130974244.14629523, 19: 133593729.02922115, 20: 136265603.60980558, 21: 138990915.68200168, 22: 141770733.99564174, 23: 144606148.67555454, 24: 147498271.6490657, 25: 150448237.082047, 26: 153457201.82368788, 27: 156526345.8601617, 28: 159656872.77736494, 29: 162850010.2329122, 30: 166107010.43757048}, 'cont_dev': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 0.0, 5: 0.0, 6: 0.0, 7: 0.0, 8: 0.0, 9: 0.0, 10: 132709405.85282089, 11: 186809472.0643056, 12: 218947900.1827935, 13: 201723477.3617778, 14: 183588823.26678458, 15: 167626101.52193978, 16: 170013584.4328817, 17: 169375808.7700985, 18: 170362966.2145667, 19: 174719437.5663355, 20: 177504162.6620391, 21: 180361514.83447984, 22: 183292542.61395732, 23: 186298325.1410851, 24: 189379972.5489935, 25: 192538626.35866466, 26: 195775459.8875309, 27: 199091678.6714741, 28: 202488520.90036955, 29: 205967257.8673235, 30: 209529194.43175867}, 'PPE_LB_Airframe': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 158819373.60448977, 5: 242993641.61486936, 6: 247853514.44716677, 7: 505621169.4722201, 8: 257866796.4308323, 9: 263024132.35944897, 10: 89428205.00221264, 11: 91216769.1022569, 12: 93041104.48430203, 13: 94901926.5739881, 14: 19359993.02109357, 15: 19747192.88151544, 16: 20142136.73914575, 17: 20544979.473928668, 18: 20955879.06340724, 19: 21374996.644675385, 20: 21802496.577568892, 21: 22238546.509120267, 22: 22683317.439302675, 23: 23136983.78808873, 24: 23599723.463850506, 25: 24071717.93312752, 26: 24553152.291790064, 27: 25044215.337625872, 28: 25545099.644378386, 29: 26056001.637265954, 30: 26577121.670011275}, 'PPE_Machinery_Airframe': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 109188319.35308671, 5: 167058128.61022267, 6: 170399291.18242714, 7: 347614554.01215136, 8: 177283422.5461972, 9: 180829090.99712116, 10: 61481890.93902119, 11: 62711528.757801615, 12: 63965759.33295765, 13: 65245074.519616805, 14: 13309995.202001829, 15: 13576195.106041864, 16: 13847719.008162702, 17: 14124673.388325958, 18: 14407166.856092477, 19: 14695310.193214327, 20: 14989216.397078615, 21: 15289000.725020185, 22: 15594780.739520589, 23: 15906676.354311002, 24: 16224809.881397223, 25: 16549306.079025166, 26: 16880292.200605668, 27: 17217898.044617783, 28: 17562256.005510144, 29: 17913501.125620343, 30: 18271771.148132753}, 'NRC_wo_Contingency': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 1260628777.9856374, 5: 1928762030.3180254, 6: 1967337270.9243858, 7: 4013368032.6857467, 8: 2046817696.6697314, 9: 2087754050.6031258, 10: 842545783.0578837, 11: 910842576.8134699, 12: 957461667.0269408, 13: 955007519.5428082, 14: 337258767.8717148, 15: 324369445.0189686, 16: 329891794.79985106, 17: 332451583.3444073, 18: 336700256.28036165, 19: 344383473.4334463, 20: 350561479.2464922, 21: 356879977.750622, 22: 363341374.78842235, 23: 369948133.9590394, 24: 376702777.54330695, 25: 383607887.4528643, 26: 390666106.20361453, 27: 397880137.9138794, 28: 405252749.327623, 29: 412786770.86312205, 30: 420485097.6874732}, 'NRC': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 1260628777.9856377, 5: 1928762030.3180254, 6: 1967337270.9243858, 7: 4013368032.685747, 8: 2046817696.6697314, 9: 2087754050.603126, 10: 842545783.0578837, 11: 910842576.8134698, 12: 957461667.026941, 13: 955007519.5428082, 14: 337258767.8717148, 15: 324369445.0189686, 16: 329891794.79985106, 17: 332451583.34440726, 18: 336700256.2803617, 19: 344383473.43344635, 20: 350561479.2464922, 21: 356879977.7506219, 22: 363341374.7884223, 23: 369948133.9590394, 24: 376702777.5433069, 25: 383607887.4528643, 26: 390666106.2036145, 27: 397880137.91387945, 28: 405252749.32762307, 29: 412786770.863122, 30: 420485097.6874731}, 'NRC_amort': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 372713207.41053647, 5: 570251207.3381208, 6: 581656231.4848832, 7: 1186578712.2291617, 8: 605155143.2368726, 9: 617258246.1016101, 10: 209867803.67454743, 11: 214065159.74803835, 12: 218346462.94299912, 13: 222713392.20185915, 14: 45433532.00917926, 15: 46342202.64936285, 16: 47269046.7023501, 17: 48214427.63639711, 18: 49178716.18912505, 19: 50162290.51290756, 20: 51165536.32316571, 21: 52188847.04962902, 22: 53232623.990621604, 23: 54297276.47043403, 24: 55383221.999842726, 25: 56490886.43983958, 26: 57620704.16863636, 27: 58773118.252009094, 28: 59948580.617049284, 29: 61147552.22939026, 30: 62370503.27397808}, 'NRC_non_amort': {0: 0.0, 1: 0.0, 2: 0.0, 3: 0.0, 4: 619907877.6175246, 5: 948459052.7548127, 6: 967428233.8099087, 7: 1973553596.972214, 8: 1006512334.4558295, 9: 1026642581.1449459, 10: 349058477.58928156, 11: 356039647.1410672, 12: 363160440.08388865, 13: 370423648.88556635, 14: 75566424.37265557, 15: 77077752.86010864, 16: 78619307.91731083, 17: 80191694.07565704, 18: 81795527.95717025, 19: 83431438.51631361, 20: 85100067.28663987, 21: 86802068.63237262, 22: 88538110.00502005, 23: 90308872.20512056, 24: 92115049.64922294, 25: 93957350.64220735, 26: 95836497.65505144, 27: 97753227.60815263, 28: 99708292.16031572, 29: 101702458.00352189, 30: 103736507.16359237}}

        dmc_df = pd.DataFrame.from_dict(dmc)
        activ_df = pd.DataFrame({'Business': ['Manufacturer1', 'Manufacturer1', 'Manufacturer2'],
                                 'AC_list': ['A320', 'A321', 737],
                                 'AC_Sales': [True, True, True],
                                 'Services': [True, True, False],
                                 'FHS': [True, False, False]})

        values_dict = {
            f'{self.study_name}.Business.activation_df': activ_df,
            f'{self.study_name}.nrc': nrc_df,
            f'{self.study_name}.Business.A320.nrc': nrc_df,
            f'{self.study_name}.Business.A321.nrc': nrc_df,
            f'{self.study_name}.rc': rc_df,
            f'{self.study_name}.dmc_df': dmc_df,
            f'{self.study_name}.Business.A320.dmc_df': dmc_df,
            f'{self.study_name}.Business.A321.dmc_df': dmc_df,
            f'{self.study_name}.yearly_fh': 3306.723109872893,
            f'{self.study_name}.Business.A320.yearly_fh': 3306.723109872893,
            f'{self.study_name}.Business.A321.yearly_fh': 3306.723109872893,
            f'{self.study_name}.sales_qty_df_ramped': sls_qty_df,
            f'{self.study_name}.sale_price': sale_price_df,
            f'{self.study_name}.WACC_actor': 8,
            f'{self.study_name}.actor_name': 'Manufacturer1',
            f'{self.study_name}.actor_wacc': 8,
            f'{self.study_name}.escalation_revenue_period2': 2.0,
            f'{self.study_name}.year_start_escalation_revenue': 2020,
            f'{self.study_name}.year_start_escalation_rc': 2020,
            f'{self.study_name}.year_start_escalation_price': 2020,
            f'{self.study_name}.manufacturer_name': 'Manufacturer1',
            f'{self.study_name}.EIS': 2030}

        setup_data_list.append(values_dict)
        return setup_data_list


if '__main__' == __name__:
    uc_cls = Study()
    uc_cls.load_data()
    print(uc_cls.execution_engine.dm.get_value(
        'usecase_simple_architecture.Business.activation_df'))
    uc_cls.run()

#     ppf = PostProcessingFactory()
#     for disc in uc_cls.execution_engine.root_process.sos_disciplines:
#         if disc.sos_name == 'Manufacturer1':
#             filters = ppf.get_post_processing_filters_by_discipline(
#                 disc)
#             graph_list = ppf.get_post_processing_by_discipline(
#                 disc, filters, as_json=False)
#
#             for graph in graph_list:
#                 graph.to_plotly()
